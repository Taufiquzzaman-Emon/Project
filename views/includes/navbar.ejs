<!-- Enhanced Dynamic Navbar -->
<link rel="stylesheet" href="/css/navbar.css" />

<nav class="enhanced-navbar sticky-top">
  <div class="navbar-backdrop"></div>
  <div class="container-fluid navbar-content">
    <!-- Brand Section -->
    <div class="brand-section">
      <a class="navbar-brand" href="/listings">
        <div class="brand-icon">
          <i class="fa-solid fa-paper-plane"></i>
        </div>
        <span class="brand-text">Voyago</span>
        <div class="brand-glow"></div>
      </a>
    </div>

    <!-- Central Navigation & Search -->
    <div class="central-nav-section">
      <!-- Navigation Link -->
      <div class="nav-item">
        <a class="nav-link" href="/listings">
          <i class="fa-solid fa-house me-2"></i>
          <span>Stays</span>
        </a>
      </div>

      <!-- Simplified Search Box -->
      <div class="search-container">
        <form action="/listings" method="GET" class="search-form">
          <div class="search-box">
            <input
              type="text"
              name="location"
              placeholder="Search destinations, hotels, or locations"
              class="search-input"
            />
            <button type="submit" class="search-btn">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Right Section -->
    <div class="right-section">
      <!-- Host Link -->
      <a class="host-link d-none d-lg-flex" href="/listings/new">
        <i class="fas fa-home me-2"></i>
        <span>Offer a Stay</span>
      </a>

      <!-- My Bookings (if logged in) -->
      <% if (typeof currUser !== 'undefined' && currUser) { %>
      <a class="bookings-link d-none d-md-flex" href="/bookings">
        <i class="fas fa-calendar-alt me-2"></i>
        <span>My Bookings</span>
      </a>
      <% } %>

      <!-- Notifications (if logged in) -->
      <% if(currUser) { %>
      <div class="notification-dropdown">
        <button
          class="notification-btn"
          type="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <i class="fa-solid fa-bell"></i>
          <% if (pendingCount && pendingCount > 0) { %>
          <span class="notification-badge">
            <%= pendingCount > 9 ? '9+' : pendingCount %>
          </span>
          <% } %>
          <div class="notification-ripple"></div>
        </button>
        <ul class="dropdown-menu notification-menu">
          <li class="dropdown-header">
            <i class="fas fa-bell me-2"></i>Notifications
          </li>
          <li><hr class="dropdown-divider" /></li>
          <li>
            <a class="dropdown-item notification-item" href="/bookings/owner">
              <div class="notification-icon">
                <i class="fas fa-calendar-check"></i>
              </div>
              <div class="notification-content">
                <div class="notification-title">Pending Bookings</div>
                <div class="notification-desc">
                  <% if (pendingCount && pendingCount > 0) { %> <%= pendingCount
                  %> <%= pendingCount === 1 ? 'booking' : 'bookings' %> awaiting
                  review <% } else { %> No pending bookings <% } %>
                </div>
              </div>
            </a>
          </li>
        </ul>
      </div>
      <% } %>

      <!-- User Menu -->
      <div class="user-dropdown">
        <button
          class="user-menu-btn"
          type="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <div class="user-menu-icon">
            <i class="fa-solid fa-bars"></i>
            <i class="fa-solid fa-user-circle"></i>
          </div>
        </button>

        <ul class="dropdown-menu user-menu">
          <% if (typeof currUser === 'undefined' || !currUser) { %>
          <li class="dropdown-header">Welcome to Voyago</li>
          <li><hr class="dropdown-divider" /></li>
          <li>
            <a class="dropdown-item user-menu-item" href="/login">
              <i class="fa-solid fa-arrow-right-to-bracket"></i>
              <span>Login</span>
            </a>
          </li>
          <li>
            <a class="dropdown-item user-menu-item" href="/register">
              <i class="fa-regular fa-registered"></i>
              <span>Sign up</span>
            </a>
          </li>
          <% } else { %>
          <li class="dropdown-header">
            <div class="user-info">
              <div class="user-avatar">
                <%= currUser.username.charAt(0).toUpperCase() %>
              </div>
              <span>Hello, <%= currUser.username %>!</span>
            </div>
          </li>
          <li><hr class="dropdown-divider" /></li>
          <li>
            <a class="dropdown-item user-menu-item logout-item" href="/logout">
              <i class="fa-solid fa-right-from-bracket"></i>
              <span>Logout</span>
            </a>
          </li>
          <% } %>
        </ul>
      </div>
    </div>
  </div>
</nav>

<script src="/js/navbar.js"></script>
